---
amcrest:
  - name: Front Door Bell
    host: !secret ad410_host
    username: !secret ad410_username
    password: !secret ad410_password
    resolution: high
    stream_source: rtsp
    scan_interval: 15
    binary_sensors:
      - online
      - motion_detected
      - crossline_detected
    switches:
      - privacy_mode

  - name: Front Door Bell Sub
    host: !secret ad410_host
    username: !secret ad410_username
    password: !secret ad410_password
    resolution: low
    stream_source: rtsp
    scan_interval: 30

template:
  - trigger:
      - platform: event
        event_type: amcrest
        id: start
        event_data:
          camera: "Front Door Bell"
          event: CrossRegionDetection
          payload:
            code: CrossRegionDetection
            action: Start
            data:
              Action: Appear
              object:
                ObjectType: Human
      - platform: event
        event_type: amcrest
        id: stop
        event_data:
          camera: "Front Door Bell"
          event: CrossRegionDetection
          payload:
            code: CrossRegionDetection
            action: Stop
            data:
              Action: Appear
              object:
                ObjectType: Human
    binary_sensor:
      - name: Front Door Bell Human
        icon: mdi:motion-sensor
        state: >-
          {{ 'on' if trigger.id == 'start' else 'off' }}

  - trigger:
      - platform: event
        event_type: amcrest
        id: start
        event_data:
          camera: "Front Door Bell"
          event: CallNoAnswered
          payload:
            code: CallNoAnswered
            action: Start
      - platform: event
        event_type: amcrest
        id: stop
        event_data:
          camera: "Front Door Bell"
          event: CallNoAnswered
          payload:
            code: CallNoAnswered
            action: Stop
    binary_sensor:
      - name: Front Door Bell Ring
        icon: mdi:doorbell-video
        state: >-
          {{ 'on' if trigger.id == 'start' else 'off' }}

  - trigger:
      - platform: event
        event_type: amcrest
        id: start
        event_data:
          camera: "Front Door Bell"
          event: VideoMotion
          payload:
            code: VideoMotion
            action: Start
            data:
              Action: Appear
              object:
      - platform: event
        event_type: amcrest
        id: stop
        event_data:
          camera: "Front Door Bell"
          event: VideoMotion
          payload:
            code: VideoMotion
            action: Stop
            data:
              Action: Appear
    binary_sensor:
      - name: Front Door Bell Motion
        icon: mdi:motion
        state: >-
          {{ 'on' if trigger.id == 'start' else 'off' }}
